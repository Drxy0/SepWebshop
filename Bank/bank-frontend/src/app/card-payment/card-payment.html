@if (loading()) {
  <div class="loading-state">
    <div class="message-box">
      Loading...
    </div>
  </div>
} @else if (!payment()) {
  <div class="error-state">
    <div class="message-box">
      Payment not found
    </div>
  </div>
} @else {
  <!-- Payment form -->
  <div class="payment-container">
    <div class="payment-card">

      <h2 class="bank-title">Secure Card Payment</h2>

      <div class="amount-box">
        <span>Total amount</span>
        <strong>
          {{ payment()?.amount?.toFixed(2) }} {{ payment()?.currency }}
        </strong>
      </div>

      <form [formGroup]="form">

        <div class="form-group">
          <label>Cardholder name</label>
          <input
            formControlName="cardHolder"
            placeholder="Enter card holder name..."
          />
        </div>

        <div class="card-info-group">

          <div class="form-group">
            <label>Card number</label>
            <input
              formControlName="cardNumber"
              placeholder="Enter card number..."
            />
          </div>

          <div class="card-logos">
            @if (cardBrand() === 'VISA') {
              <img src="/assets/visa.png" alt="Visa" />
            }
            @if (cardBrand() === 'MASTERCARD') {
              <img src="/assets/mastercard.png" alt="MasterCard" />
            }
          </div>

        </div>

        <div class="form-row">

          <div class="form-group">
            <label>Expiry date</label>
            <input
              formControlName="expiry"
              placeholder="MM/YY"
            />
          </div>

          <div class="form-group">
            <label>CVV</label>
            <input
              type="password"
              formControlName="cvv"
              placeholder="Enter security code..."
            />
          </div>

        </div>

        <button
          class="pay-button"
          type="button"
          [disabled]="submitDisabled()"
          (click)="handleSubmit()"
        >
          {{ submitting() ? 'Processing...' : 'Pay securely' }}
        </button>

        @if (error()) {
          <div class="error-text">
            {{ error() }}
          </div>
        }

      </form>

    </div>
  </div>
}